# ReaderWriter

A thread-safe implementation of the classic Reader-Writer synchronization problem in .NET 9.

## Quick Start

```bash
# Clone and build
git clone https://github.com/yourusername/readerwriter.git
cd readerwriter
dotnet build

# Run tests
dotnet test

# Run simulation
cd ReaderWriter.ConsoleApp
dotnet run
```

## What It Does

Demonstrates concurrent access patterns where:
- **Multiple readers** can access a shared resource simultaneously
- **Writers** get exclusive access (no other readers or writers)
- All access is thread-safe and logged

## Project Structure

```
ReaderWriter.sln
├── ReaderWriter.Core/          # Thread-safe reader-writer logic
├── ReaderWriter.ConsoleApp/    # Simulation host
└── ReaderWriter.Tests/         # Unit tests
```

## Configuration

Edit `appsettings.json` to control the simulation:

```json
{
  "SimulationSettings": {
    "NumberOfReaders": 10,      # Concurrent readers
    "NumberOfWriters": 3,       # Concurrent writers
    "SimulationDurationSeconds": 30
  }
}
```

## Sample Output

```
[20:42:57 INF] Writer 2 attempting to acquire write lock
[20:42:57 INF] Writer 2 acquired write lock
[20:42:57 INF] Writer 2 wrote data: Data from Writer 2 - Item 1. Total items: 1
[20:42:57 INF] Writer 2 released write lock
[20:42:57 INF] Reader 4 acquired read lock
[20:42:57 INF] Reader 7 acquired read lock
[20:42:57 INF] Reader 4 read data: Data from Writer 2 - Item 1
[20:42:57 INF] Reader 7 read data: Data from Writer 2 - Item 1
```

## Running on Different Platforms

### Windows
```powershell
.\ReaderWriter.ConsoleApp\localrun.ps1
```

### Linux/macOS
```bash
bash simple-run.sh
```

### Published Binary
```bash
# Build self-contained executable
dotnet publish -c Release -r win-x64 --self-contained
dotnet publish -c Release -r linux-x64 --self-contained

# Run with custom parameters
./ReaderWriter.ConsoleApp --readers 20 --writers 5 --duration 60
```

## Technical Details

- **Synchronization**: `ReaderWriterLockSlim` (.NET built-in)
- **Logging**: Serilog → Console + Daily rolling files
- **DI Container**: Microsoft.Extensions.DependencyInjection
- **Testing**: xUnit with high concurrency scenarios
- **Patterns**: SOLID, DDD, Dependency Injection

## Test Coverage

- ✅ Basic read/write operations
- ✅ Writer blocks concurrent readers
- ✅ Writer blocks concurrent writers
- ✅ Multiple readers run concurrently
- ✅ Data integrity under high concurrency
- ✅ Cancellation and cleanup

## License

AGPL - See LICENSE.txt

---

*Note: Implementation generated by Claude Opus 4 from specification by Gemini 2.5 Pro*
